<!DOCTYPE html>
<html lang="en">
    <head id="zeta">
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=1920,height=1080,initial-scale=1" />
        <meta name="source" content="https://github.com/okaq/moonshot" />
        <meta name="author" content="AQ<aq@okaq.com>" />
        <meta name="date" content="2021-03-20" />
	<link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAMElEQVR4nOzNMREAMAzDwF4vg/kjDol4ewHQT5LX7FfvAAAAAAAAAAAA4LANAAD//9duAFsRg4sHAAAAAElFTkSuQmCC" />
	<style type="text/css">
            html,body{width:1920px;overflow:auto;height:1080px;margin:0px;border:0px;padding:0px;background-color:rgba(0,0,0,0);}
        </style>
        <!-- three.js 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/104/three.min.js"></script>
	-->
	<!-- web font -->
	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
        <script type="text/javascript">
            // ok
            console.log("okaq moony ok!");
            // async load
            (function() {
                var a = {
                    "load": function(e) {
                        console.log(e);
                        g.init();
                    }
                }
                document.addEventListener("DOMContentLoaded", a.load, false);
            })();
// game
var g = {
        "init": function() {
            var t0 = window.performance.now();
            console.log("moon shot...");

		// subs
		g.subs = [dom,sce,txt];
		g.subs.forEach(function(el){el.init();});

		ren.clear();

		g.txt = " o k a q ";

		ren.txt();

		window.setTimeout(g.load, 1000);

		console.log("total render time: " + (window.performance.now() - t0));
    },
	"load": function() {
		let WebFontConfig = {};
		WebFontConfig.google = {};
		// WebFontConfig.google.families = ["Droid Sans"];
		WebFontConfig.google.families = [txt.b[2]];
		WebFontConfig.active = g.active;
		WebFontConfig.inactive = g.inactive;

		console.log(WebFont);
		// WebFont.addEventListener("active", g.active, false);
		// WebFont.addEventListener("inactive", g.inactive, false);

		WebFont.load(WebFontConfig);
	},
	"active": function(e) {
		console.log(e);

		window.setTimeout(g.hum, 2000);
	},
	"hum": function() {
		ren.clear();
		ren.txt2();

		window.setTimeout(g.hum2, 1000);
	},
	"hum2": function() {
		// text metrics web api
		let m0 = sce.a.c.con.measureText(g.txt);
		console.log(m0);

		window.setTimeout(g.loop, 1000);
	},
	"inactive": function(e) {
		console.log(e);
	},
	"save": function() {
		// to data url, base64 png
		// let d0 = sce.a.c.can.toDataURL();
		// let s0 = d0.split(".")[1];
		// let s1 = atob(s0);
		// let d1 = [];
		// for (let i = 0; i < d0.length; i++) {
		//         let b0 = d0.charCodeAt(i);
		//         d1.push(b0);
		// }
		// let b1 = new Uint8Array(d1);
		// let b2 = new Blob([b1],{type:"image/png"});

		// fetch post blob to server
		// localStorage.img0 = b2
		// let fd0 = new FormData();
		// fd0.append("img0", localStorage.b2, "img0.png");
		// let url0 = "http://localhost:8080/a";
		// let p0 = {};
		// p0.method = "POST";
		// p0.body = fd0;
		// window.fetch(url0,p0)
		
	},
	"loop": function() {
		// ping pong promises
		// per cycle, fetch font, render, save
		
		// setup font list
		txt.list();
		g.tick = 0;
		// g.id = window.setInterval(g.frame, 1000);
		window.setTimeout(g.frame2, 1000);
	},
	"frame": function() {
		// not interval fired, but future callbacks
		if (g.tick >= txt.d.length) {
			console.log("txt list done");
			window.clearInterval(g.id);
			return;
		}

		let txt0 = txt.d[g.tick];
		console.log(txt0);

		g.tick = g.tick + 1;
	},
	"frame2": function() {
		// sanity check
		if (g.tick >= txt.d.length) {
			console.log("txt list done");
			console.log("total fonts loaded: " + txt.d.length);
			return;
		}
		// create new config 
		let wfc0 = {};
		wfc0.google = {};
		let txt0 = txt.d[g.tick];
		wfc0.google.families = [txt0];
		wfc0.active = function() {
			console.log("tick count: " + g.tick);
			console.log("loading font: " + txt0);
			ren.clear();
			ren.txt3();
			g.tick = g.tick + 1;
			window.setTimeout(g.frame2, 1000);
		};
		wfc0.inactive = function() {
			console.log("font load error");
			// continue
			g.tick = g.tick + 1;
			window.setTimeout(g.frame2, 1000);
		};
		WebFont.load(wfc0);
	}
}
// fonts
var txt = {
	"init": function() {
		txt.a = " o k a q ";
		txt.b = [];
		txt.b[0] = "Droid Sans";
		txt.b[1] = "Roboto";
		txt.b[2] = "Tangerine";
	},
	"list": function() {
		txt.c = "okaq";
		txt.d = [];
		txt.d[0] = "Droid Sans";
		txt.d[1] = "Tangerine";
		txt.d[2] = "Roboto";
		txt.d[3] = "Syne Mono";
		txt.d[4] = "Chango";
		txt.d[5] = "Open Sans";
		txt.d[6] = "Ranchers";
		txt.d[7] = "Noto Sans JP";
		txt.d[8] = "Lato";
		txt.d[9] = "Montserrat";
		txt.d[10] = "Pangolin";
		txt.d[11] = "Roboto Condensed";
		txt.d[12] = "Source Sans Pro";
		txt.d[13] = "Oswald";
		txt.d[14] = "Cormorant Unicase";
		txt.d[15] = "Poppins";
		txt.d[16] = "Roboto Mono";
		txt.d[17] = "Raleway";
		txt.d[18] = "Noto Sans";
		txt.d[19] = "PT Sans";
		txt.d[20] = "Merriweather";
		txt.d[21] = "Roboto Slab";
		txt.d[22] = "Ubuntu";
		txt.d[23] = "Playfair Display";
		txt.d[24] = "Nunito";
		txt.d[25] = "Blinker";
		txt.d[26] = "Open Sans Condensed";
		txt.d[27] = "Noto Sans KR";
		txt.d[28] = "Rubik";
		txt.d[29] = "Noto Sans TC";
		txt.d[30] = "Lora";
		txt.d[31] = "Della Respira";
		txt.d[32] = "PT Serif";
		txt.d[33] = "Nunito Sans";
		txt.d[34] = "Work Sans";
		txt.d[35] = "Nanum Gothic";
		txt.d[36] = "Noto Serif";
		txt.d[37] = "Mukta";
		txt.d[38] = "Fira Sans";
		txt.d[39] = "Quicksand";
		txt.d[40] = "Titillium Web";
		txt.d[41] = "Recursive";
		txt.d[42] = "Hind Siliguri";
		txt.d[43] = "Inter";
		txt.d[44] = "Karla";
		txt.d[45] = "Barlow";
		txt.d[46] = "Inconsolata";
		txt.d[47] = "Oxygen";
		txt.d[48] = "PT Sans Narrow";
		txt.d[49] = "Heebo";
		txt.d[50] = "Newsreader";
		txt.d[51] = "Anton";
		txt.d[52] = "Dosis";
		txt.d[53] = "Yanone Kaffeesatz";
		txt.d[54] = "Josefin Sans";
		txt.d[55] = "Source Code Pro";
		txt.d[56] = "Arimo";
		txt.d[57] = "Noto Sans SC";
		txt.d[58] = "Libre Franklin";
		txt.d[59] = "Bebas Neue";
		txt.d[60] = "Libre Baskerville";
		txt.d[61] = "Cabin";
		txt.d[62] = "Redressed";
		txt.d[63] = "Bitter";
		txt.d[64] = "Crimson Text";
		txt.d[65] = "Hind";
		txt.d[66] = "Lobster";
		txt.d[67] = "Noto Sans HK";
		txt.d[68] = "Abel";
		txt.d[69] = "IBM Plex Sans";
		txt.d[70] = "Dancing Script";
		txt.d[71] = "Source Serif Pro";
		txt.d[72] = "Fjalla One";
		txt.d[73] = "Berkshire Swash";
		txt.d[74] = "Staatliches";
		txt.d[75] = "Antic Slab";
		txt.d[76] = "Exo";
		txt.d[77] = "Padauk";
		txt.d[78] = "Barlow Condensed";
		txt.d[79] = "Zilla Slab";
		txt.d[80] = "Cairo";
		txt.d[81] = "Comfortaa";
		txt.d[82] = "Varela Round";
		txt.d[83] = "Arvo";
		txt.d[84] = "DM Sans";
		txt.d[85] = "Indie Flower";
		txt.d[86] = "Kanit";
		txt.d[87] = "Baloo Tammudu 2";
		txt.d[88] = "Pacifico";
		txt.d[89] = "Exo 2";
		txt.d[90] = "EB Garamond";
		txt.d[91] = "Asap";
		txt.d[92] = "Merriweather Sans";
		txt.d[93] = "Shadows Into Light";
		txt.d[94] = "Prompt";
		txt.d[95] = "Questrial";
		txt.d[96] = "Architects Daughter";
		txt.d[97] = "Mulish";
		txt.d[98] = "Overpass";
		txt.d[99] = "Archivo Narrow";
		txt.d[100] = "Teko";
		txt.d[101] = "JetBrains Mono";
		txt.d[102] = "Rajdhani";
		txt.d[103] = "Hind Madurai";
		txt.d[104] = "Maven Pro";
		txt.d[105] = "Abril Fatface";
		txt.d[106] = "Martel";
		txt.d[107] = "Balsamiq Sans";
		txt.d[108] = "Acme";
		txt.d[109] = "Assistant";
		txt.d[110] = "Cormorant Garamond";
		txt.d[111] = "Caveat";
		txt.d[112] = "Catamaran";
		txt.d[113] = "Play";
		txt.d[114] = "Padauk";
		txt.d[115] = "Noto Serif JP";
		txt.d[116] = "Fredoka One";
		txt.d[117] = "Tajawal";
		txt.d[118] = "Cormorant Garamond";
		txt.d[119] = "Oranienbaum";
		txt.d[120] = "Domine";
		txt.d[121] = "Amatic SC";
		txt.d[122] = "IBM Plex Serif";
		txt.d[123] = "Permanent Marker";
		txt.d[124] = "Architects Daughter";
		txt.d[125] = "Signika";
		txt.d[126] = "Bree Serif";
		txt.d[127] = "Alfa Slab One";
		txt.d[128] = "Righteous";
		txt.d[129] = "Nanum Myeongjo";
		txt.d[130] = "Vollkorn";
		txt.d[131] = "PT Sans Caption";
		txt.d[132] = "Amiri";
		txt.d[133] = "Patua One";
		txt.d[134] = "Crete Round";
		txt.d[135] = "Archivo";
		txt.d[136] = "Barlow Semi Condensed";
		txt.d[137] = "Satisfy";
		txt.d[138] = "Cinzel";
		txt.d[139] = "Frank Ruhl Libre";
		txt.d[140] = "ABeeZee";
		txt.d[141] = "Courgette";
		txt.d[142] = "Changa";
		txt.d[143] = "Brygada 1918";
		txt.d[144] = "Alegreya";
		txt.d[145] = "Manrope";
		txt.d[146] = "Bangers";
		txt.d[147] = "Alegreya Sans";
		txt.d[148] = "Saira Condensed";
		txt.d[149] = "Ubuntu Condensed";
		txt.d[150] = "Oi";
		txt.d[151] = "Spartan";
		txt.d[152] = "Patrick Hand";
		txt.d[153] = "Lobster Two";
		txt.d[154] = "Russo One";
		txt.d[155] = "Archivo Black";
		txt.d[156] = "Tinos";
		txt.d[157] = "Almarai";
		txt.d[158] = "Great Vibes";
		txt.d[159] = "Cardo";
		txt.d[160] = "Kaushan Script";
		txt.d[161] = "IBM Plex Mono";
		txt.d[162] = "Cuprum";
		txt.d[163] = "Francois One";
		txt.d[164] = "Baloo 2";
		txt.d[165] = "Yantramanav";
		txt.d[166] = "Kalam";
		txt.d[167] = "Sacramento";
		txt.d[168] = "Noticia Text";
		txt.d[169] = "Concert One";
		txt.d[170] = "Gothic A1";
		txt.d[171] = "Pathway Gothic One";
		txt.d[172] = "Didact Gothic";
		txt.d[173] = "Chivo";
		txt.d[174] = "Cantarell";
		txt.d[175] = "Prata";
		txt.d[176] = "Ramabhadra";
		txt.d[177] = "Squada One";
		txt.d[178] = "Rokkitt";
		txt.d[179] = "Fascinate";
		txt.d[180] = "Old Standard TT";
		txt.d[181] = "Sarabun";
		txt.d[182] = "Quattrocento Sans";
		txt.d[183] = "Gloria Hallelujah";
		txt.d[184] = "Yellowtail";
		txt.d[185] = "Passion One";
		txt.d[186] = "Encode Sans";
		txt.d[187] = "Secular One";
		txt.d[188] = "Red Hat Display";
		txt.d[189] = "Orbitron";
		txt.d[190] = "Monda";
		txt.d[191] = "Asap Condensed";
		txt.d[192] = "Sawarabi Mincho";
		txt.d[193] = "Montserrat Alternates";
		txt.d[194] = "Hind Guntur";
		txt.d[195] = "Philosopher";
		txt.d[196] = "Press Start 2P";
		txt.d[197] = "Rock Salt";
		txt.d[198] = "Public Sans";
		txt.d[199] = "Josefin Slab";
		txt.d[200] = "Ultra";
		txt.d[201] = "Playfair Display SC";
		txt.d[202] = "News Cycle";
		txt.d[203] = "Quantico";
		txt.d[204] = "Ropa Sans";
		txt.d[205] = "Sanchez";
		txt.d[206] = "Parisienne";
		txt.d[207] = "Cookie";
		txt.d[208] = "Merienda";
		txt.d[209] = "Istok Web";
		txt.d[210] = "Quattrocentro";
		txt.d[211] = "Vidaloka";
		txt.d[212] = "Handlee";
		txt.d[213] = "Volkhov";
		txt.d[214] = "Chakra Petch";
		txt.d[215] = "Cormorant";
		txt.d[216] = "JetBrains Mono";
		txt.d[217] = "Arapey";
		txt.d[218] = "Poiret One";
		txt.d[219] = "Special Elite";
		txt.d[220] = "Faustina";
		txt.d[221] = "Hind Vadodara";
		txt.d[222] = "Pragati Narrow";
		txt.d[223] = "Advent Pro";
		txt.d[224] = "Akaya Kanadaka";
		txt.d[225] = "Saira";
		txt.d[226] = "Spectral";
		txt.d[227] = "Unica One";
		txt.d[228] = "Jost";
		txt.d[229] = "Neuton";
		txt.d[230] = "Karma";
		txt.d[231] = "Fira Sans Extra Condensed";
		txt.d[232] = "Hammersmith One";
		txt.d[233] = "Neucha";
		txt.d[234] = "DM Serif Display";
		txt.d[235] = "Luckiest Guy";
		txt.d[236] = "Khand";
		txt.d[237] = "Jura";
		txt.d[238] = "Taviraj";
		txt.d[239] = "Economica";
		txt.d[240] = "Shippori Mincho";
		txt.d[241] = "Jaldi";
		txt.d[242] = "Ruda";
		txt.d[243] = "Sigmar One";
		txt.d[244] = "Encode Sans Condensed";
		txt.d[245] = "Noto Serif TC";
		txt.d[246] = "Cabin Condensed";
		txt.d[247] = "Actor";
		txt.d[248] = "Mitr";
		txt.d[249] = "Electrolize";
		txt.d[250] = "Do Hyeon";
		txt.d[251] = "Nothing You Could Do";
		txt.d[252] = "Damion";
		txt.d[253] = "Saira Semi Condensed";
		txt.d[254] = "Space Mono";
		txt.d[255] = "Gudea";
		txt.d[256] = "Scheherazade";
		txt.d[257] = "Gruppo";
		txt.d[258] = "Paytone One";
		txt.d[259] = "Alice";
		txt.d[260] = "El Messiri";
		txt.d[261] = "PT Mono";
		txt.d[262] = "Julius Sans One";
		txt.d[263] = "Pontano Sans";
		txt.d[264] = "Gentium Basic";
		txt.d[265] = "Monoton";
		txt.d[266] = "BenchNine";
		txt.d[267] = "Khula";
		txt.d[268] = "Carter One";
		txt.d[269] = "Sawarabi Gothic";
		txt.d[270] = "Bungee";
		txt.d[271] = "Adamina";
		txt.d[272] = "Armata";
		txt.d[273] = "Homemade Apple";
		txt.d[274] = "Playball";
		txt.d[275] = "Six Caps";
		txt.d[276] = "Bad Script";
		txt.d[277] = "Amaranth";
		txt.d[278] = "Aleo";
		txt.d[279] = "Bai Jumjuree";
		txt.d[280] = "Unna";
		txt.d[281] = "Varela";
		txt.d[282] = "Markazi Text";
		txt.d[283] = "Truculenta";
		txt.d[284] = "Noto Serif SC";
		txt.d[285] = "Alef";
		txt.d[286] = "Palanquin";
		txt.d[287] = "Lusitana";
		txt.d[288] = "Yeseva One";
		txt.d[289] = "Marck Script";
		txt.d[290] = "Mali";
		txt.d[291] = "Antic";
		txt.d[292] = "Allura";
		txt.d[293] = "Tenor Sans";
		txt.d[294] = "Viga";
		txt.d[295] = "Marcellus";
		txt.d[296] = "Allan";
		txt.d[297] = "Fugaz One";
		txt.d[298] = "Aclonica";
		txt.d[299] = "Signika Negative";
		txt.d[300] = "Gentium Book Basic";

	}
}
// scene
var sce = {
	"init": function() {
		sce.a = {};
		sce.a.r = [1920,1080,0,0];
		sce.a.c = dom.canvas(sce.a.r);
		dom.add(sce.a.c);
		sce.a.c.can.addEventListener("click", sce.click, false);
	},
	"click": function(e) {
		console.log(e);
	}
}
// render
var ren = {
	"clear": function() {
		sce.a.c.con.fillStyle = rgba.rand();
		sce.a.c.con.fillRect(0,0,sce.a.c.can.width,sce.a.c.can.height);
	},
	"txt": function() {
		sce.a.c.con.fillStyle = rgba.rand();
		sce.a.c.con.font = "128px Monospace";
		sce.a.c.con.fillText(g.txt, 576, 476);
	},
	"txt2": function() {
		sce.a.c.con.fillStyle = rgba.rand();
		sce.a.c.con.font = "128px Tangerine";
		sce.a.c.con.fillText(txt.a, 576, 476);

		// adjust variant weight and face params
	},
	"txt3": function() {
		sce.a.c.con.fillStyle = rgba.rand();
		let txt0 = txt.d[g.tick];
		let txt1 = "256px " + txt0;
		sce.a.c.con.font = txt1;
		sce.a.c.con.fillText(txt.c, 448, 874);
	}
}
   // dom
   var dom = {
        "init": function() {
            dom.alpha = document.getElementById("alpha");
            console.log(dom.alpha);
        },
        "canvas": function(r0) {
            var c0 = {};
            c0.can = document.createElement("canvas");
            c0.con = c0.can.getContext("2d");
            c0.can.width = r0[0];
            c0.can.height = r0[1];
            c0.can.style.position = "absolute";
            c0.can.style.top = r0[3] + "px";
            c0.can.style.left = r0[2] + "px";
            return c0;
        },
        "canvas2": function(r0) {
            var c0 = {};
            c0.can = document.createElement("canvas");
            // c0.con = c0.can.getContext("2d");
            // let threejs create the wegbl context
            c0.can.width = r0[0];
            c0.can.height = r0[1];
            c0.can.style.position = "absolute";
            c0.can.style.top = r0[3] + "px";
            c0.can.style.left = r0[2] + "px";
            return c0;
        },
        "add": function(c0) {
            dom.alpha.appendChild(c0.can);
        },
        "remove": function(c0) {
            dom.alpha.removeChild(c0.can);
        }
    }
    // colors
    var rgba = {
        "rc": function() {
            // return random rgba
            var c0 = [
                rgba.rb(),
                rgba.rb(),
                rgba.rb(),
                1.0
                ];
            return c0;
        },
        "css": function(c0) {
            // return css string
            return "rgba(" + c0.join(",") + ")";
        },
        "rb": function() {
            // random byte
            return (Math.random() * 255) >>> 0;
        },
        "rba": function(size0) {
            // random byte array length of input
            var r0 = [];
            for (var i = 0; i < size0; i++) {
                r0.push(rgba.rb());
            }
            return r0;
        },
        "rand": function() {
            return rgba.css(rgba.rc());
        },
        "mono": function(c0) {
            return rgba.css([c0,c0,c0,1.0]);
        },
        "rmon": function() {
            var c0 = rgba.rb();
            return rgba.mono(c0);
        }
    }
</script>
	<!--
	<script src="http://localhost:8080/p5/kinetic2.js"></script>
        -->
    	</head>
        <body id="alpha">
        </body>
    </html>




